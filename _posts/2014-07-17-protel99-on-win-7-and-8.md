---
layout: post
title: 关于Protel99se在Windows7及Windows8上面加载元件库
date: 2014-07-17 15:22:08
categories: 技术
tags: Protel PCB DIY
---

最近装了一个Protel99se，发现加载额外的元件库的时候会提示“File is no recognized”。网上找到的中文解决办法大都是修改默认加载元件库的描述ini文件。这种方法很麻烦，加载一个元件库就需要修改ini文件。

于是特意翻墙使用国际著名搜索引擎查找一下老外的解决办法，发现在这个地址：http://www.diyaudio.com/forums/parts/51279-loading-library-file-protel-99-a-3.html 里面有老外花了“a long day”用程序调试的方法查找了一下问题原因。具体原因可以看连接原文，大意是Win7之后的一个文件打开对话框的变化，导致Protel99se sp6加载元件库时候，返回的元件库文件的完全路径有错误，导致加载失败。

老外的解决办法是修改程序的二进制文件中调用相应接口的方式，绕过了导致问题的调用方法，之后就问题就解决了。原文的楼主修改的是加载PCB设计元件库的问题，之后又有其他人根据他的思路修改了原理图元件库的问题，这样常用的两块功能就没有问题了。

我按照原文的方法做了修改，验证问题确实得到解决。考虑到Protel99se的sp6已经是最后版本了，之后新产品替代了Protel99se，所以这个修改之后的文件，在修改一次以后别人就不需要再修改了，所以读到本文的朋友只要使用的是没有汉化的Protel99se SP6，那么可以直接下载我修改好的文件替换安装时的主程序exe文件，就可以直接解决这个问题了。下载地址为：http://pan.baidu.com/s/1ntFQolV 。

因为我不确定汉化后的Protel99se SP6是否修改了主程序，所以建议需要汉化过后的主程序按照上面的原文的方法重新修改解决问题。
